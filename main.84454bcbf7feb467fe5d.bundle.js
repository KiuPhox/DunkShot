(()=>{"use strict";var e,t={413:(e,t,s)=>{var a=s(260),i=s.n(a);const r=600;var n;!function(e){e.TIME="time",e.SCORE="score",e.BOUNCE="bounce",e.NO_AIM="no-aim"}(n||(n={}));const h={time:{color:48639,levels:3,description:"Complete in [x] seconds"},score:{color:3658035,levels:3,description:"Complete with score [x]"},bounce:{color:16278524,levels:3,description:"Complete with [x] bounces"},"no-aim":{color:16741996,levels:3,description:"Complete with no aim"}};var l,o;!function(e){e.PRELOAD="PRELOAD",e.READY="ready",e.PLAYING="playing",e.GAME_OVER="game_over",e.PAUSE="pause",e.CUSTOMIZE="customize",e.CHALLENGES_SELECTION="challenges-selection",e.CHALLENGE_READY="challenge-ready",e.CHALLENGE_PLAYING="challenge-playing",e.CHALLENGE_COMPLETE="challenge-complete",e.SETTINGS="settings"}(l||(l={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.CHALLENGE=1]="CHALLENGE"}(o||(o={}));class c{static init(){this.emitter=new Phaser.Events.EventEmitter}static updateGameState(e,t){if(this.currentState!==e){switch(this.previousState=this.currentState,this.currentState=e,this.currentState){case l.READY:this.handleReadyState(t);break;case l.PLAYING:this.handlePlayingState(t);break;case l.PAUSE:this.handlePauseState(t);break;case l.SETTINGS:this.handleSettingsState(t);break;case l.CHALLENGE_READY:this.handleChallengeReadyState(t);break;case l.CHALLENGE_PLAYING:this.handleChallengePlayingState(t)}this.emitter.emit("game-state-changed",this.currentState,this.previousState)}}static handleReadyState(e){e.scene.start("game").start("hud")}static handlePlayingState(e){this.gameModeState=o.NORMAL,this.previousState===l.PAUSE&&e.scene.resume("game")}static handlePauseState(e){this.previousState!==l.PLAYING&&this.previousState!==l.CHALLENGE_PLAYING||e.scene.pause("game")}static handleSettingsState(e){this.previousState===l.READY&&e.scene.stop("game")}static handleChallengeReadyState(e){e.scene.start("game").start("hud")}static handleChallengePlayingState(e){this.gameModeState=o.CHALLENGE,this.previousState===l.PAUSE&&e.scene.resume("game")}static getCurrentState(){return this.currentState}static getPreviousState(){return this.previousState}static getGameModeState(){return this.gameModeState}}c.currentState=l.PRELOAD,c.previousState=l.PRELOAD,c.gameModeState=o.NORMAL;class d extends i().Scene{constructor(){super("preload")}init(){c.init()}preload(){const e=this.add.graphics(),t=this.add.text(300,.45*this.scale.height,"0%",{fontFamily:"AkzidenzGrotesk",fontSize:"36px",color:"#f2a63b"}).setOrigin();this.load.on("progress",(s=>{e.clear(),e.fillStyle(15902267,1),e.fillRect(0,.5*this.scale.height,r*s,30),t.setText(Math.round(100*s).toString()+"%")})),this.load.on("complete",(()=>{e.destroy(),c.updateGameState(l.READY,this),console.log("Loading complete")})),this.load.spritesheet("ball","assets/textures/balls-atlas.png",{frameWidth:210,frameHeight:210}),this.load.spritesheet("basket","assets/textures/basket-sheet.png",{frameWidth:354,frameHeight:56.5}),this.load.spritesheet("help","assets/textures/help-sheet.png",{frameWidth:215,frameHeight:1960/6}),this.load.spritesheet("tail","assets/textures/tails-atlas.png",{frameWidth:261,frameHeight:261}),this.load.image("net","assets/textures/net.png"),this.load.image("logo","assets/textures/logo.png"),this.load.image("star","assets/textures/star.png"),this.load.image("mini-wall","assets/textures/obstacles/miniwall.png"),this.load.image("bouncer","assets/textures/obstacles/bouncer.png"),this.load.image("shield","assets/textures/obstacles/shield_2.png"),this.load.image("item","assets/textures/shop/item.png"),this.load.image("shop-line","assets/textures/shop/shop-line.png"),this.load.image("top-ornament","assets/textures/shop/top-ornament.png"),this.load.image("reset-btn","assets/textures/btnreset.png"),this.load.image("settings-btn","assets/textures/btnsettings.png"),this.load.image("settings-mainmenu-btn","assets/textures/btnsettings-mainmenu.png"),this.load.image("settings-pause-btn","assets/textures/btnsettings-pause.png"),this.load.image("share-btn","assets/textures/btnshare.png"),this.load.image("pause-btn","assets/textures/btnpause.png"),this.load.image("resume-btn","assets/textures/btnresume.png"),this.load.image("mainmenu-btn","assets/textures/btnmainmenu.png"),this.load.image("customize-mainmenu-btn","assets/textures/btncustomize-mainmenu.png"),this.load.image("customize-btn","assets/textures/btncustomize.png"),this.load.image("challenges-btn","assets/textures/btnchallenges.png"),this.load.image("back-btn","assets/textures/btnback.png"),this.load.image("cleardata-btn","assets/textures/btncleardata.png"),this.load.image("unlimited-btn","assets/textures/btnunlimited.png"),this.load.spritesheet("rounded-btn","assets/textures/btnrounded-sheet.png",{frameHeight:122,frameWidth:224}),this.load.image("time-btn","assets/textures/challenges/time-btn.png"),this.load.image("time-btn-2","assets/textures/challenges/time-btn-2.png"),this.load.image("score-btn","assets/textures/challenges/score-btn.png"),this.load.image("score-btn-2","assets/textures/challenges/score-btn-2.png"),this.load.image("bounce-btn","assets/textures/challenges/bounce-btn.png"),this.load.image("bounce-btn-2","assets/textures/challenges/bounce-btn-2.png"),this.load.image("no-aim-btn","assets/textures/challenges/no-aim-btn.png"),this.load.image("no-aim-btn-2","assets/textures/challenges/no-aim-btn-2.png"),this.load.image("time-icon","assets/textures/challenges/time-icon.png"),this.load.image("time-icon-2","assets/textures/challenges/time-icon-2.png"),this.load.image("score-icon","assets/textures/challenges/score-icon.png"),this.load.image("score-icon-2","assets/textures/challenges/score-icon-2.png"),this.load.image("bounce-icon","assets/textures/challenges/bounce-icon.png"),this.load.image("bounce-icon-2","assets/textures/challenges/bounce-icon-2.png"),this.load.image("no-aim-icon","assets/textures/challenges/no-aim-icon.png"),this.load.image("no-aim-icon-2","assets/textures/challenges/no-aim-icon-2.png"),this.load.image("challenge-popup","assets/textures/challenges/popup.png"),this.load.image("challenge-btn","assets/textures/challenges/btn.png"),this.load.image("challenge-popup-bg","assets/textures/challenges/bg.png"),this.load.image("attempt-active","assets/textures/challenges/attempt-active.png"),this.load.image("attempt-inactive","assets/textures/challenges/attempt-inactive.png"),this.load.image("e3","assets/textures/e3.png"),this.load.image("e4","assets/textures/e4.png"),this.load.image("circle","assets/textures/circle.png"),this.load.glsl({key:"shader",url:"assets/shaders/shader.frag"}),this.load.bitmapFont("triomphe","assets/fonts/triomphe.png","assets/fonts/triomphe.xml"),this.loadAudio(),this.loadChallengeLevels()}loadAudio(){for(let e=1;e<=10;e++)this.load.audio(e.toString(),`assets/audios/notes/${e}.mp3`);this.load.audio("star","assets/audios/star.mp3"),this.load.audio("wall-hit","assets/audios/wall-hit.mp3"),this.load.audio("combo-start","assets/audios/combo-start.mp3"),this.load.audio("combo-shoot","assets/audios/combo-shoot.mp3"),this.load.audio("combo-hit","assets/audios/combo-hit.mp3"),this.load.audio("release","assets/audios/release.mp3"),this.load.audio("game-over","assets/audios/game-over.mp3"),this.load.audio("timer-buzz","assets/audios/timer-buzz.mp3")}loadChallengeLevels(){for(let e=1;e<=h[n.TIME].levels;e++)this.load.tilemapTiledJSON(`time-${e}`,`assets/challenges/time/${e}.json`);for(let e=1;e<=h[n.SCORE].levels;e++)this.load.tilemapTiledJSON(`score-${e}`,`assets/challenges/score/${e}.json`);for(let e=1;e<=h[n.BOUNCE].levels;e++)this.load.tilemapTiledJSON(`bounce-${e}`,`assets/challenges/bounce/${e}.json`);for(let e=1;e<=h[n.NO_AIM].levels;e++)this.load.tilemapTiledJSON(`no-aim-${e}`,`assets/challenges/no-aim/${e}.json`)}}var u=s(268);class g{static init(e){this.trajectoryLineGraphics=e.add.graphics(),this.normalLineGraphics=e.add.graphics(),this.trajectoryDrawable=!0}static drawLine(e,t,s){this.normalLineGraphics.clear();const a=s||10;for(let s=0;s<a;s++){const i=(t.x-e.x)/a*s+e.x,r=(t.y-e.y)/a*s+e.y;this.normalLineGraphics.fillStyle(13224393,1),this.normalLineGraphics.setDepth(-4),this.normalLineGraphics.fillCircle(i,r,7)}}static drawTrajectoryLine(e,t,s,a){if(this.trajectoryLineGraphics.clear(),this.trajectoryDrawable)for(let i=0;i<=10;i++){const n=i/20;let h=e.x+t.x*n;const l=e.y+t.y*n+s*n*n/2;h<0?h=-h:h>r&&(h=r-(h-r)),this.trajectoryLineGraphics.fillStyle(15902267,a),this.trajectoryLineGraphics.setDepth(-2),this.trajectoryLineGraphics.fillCircle(h,l,15/(i+1)+5)}}static clearTrajectoryLine(){this.trajectoryLineGraphics.clear()}static clearNormalLine(){this.normalLineGraphics.clear()}}const m=[{texure:"tail",frame:"59",colors:[16773923,16763395,16733187]},{texure:"tail",frame:"59",colors:[16504530,13519295,10895045]},{texure:"tail",frame:"59",colors:[15089261,8198453,4326678]},{texure:"tail",frame:"59",colors:[16759739,16737205,11481700]},{texure:"tail",frame:"59",colors:[16645888,10288942,3728717]},{texure:"tail",frame:"59",colors:[16772020,16760745,16755884]},{texure:"tail",frame:"59",colors:[16645888,10288942,3728717]},{texure:"tail",frame:"51",colors:[4699647,1270751,403517]},{texure:"tail",frame:"4",colors:[16773923,16763395,16733187]},{texure:"tail",frame:"55",colors:[16773923,16763395,16733187]},{texure:"tail",frame:"19",colors:[16645888,10288942,3728717]},{texure:"tail",frame:"55",colors:[16504530,13519295,10895045]},{texure:"tail",frame:"4",colors:[16750529,14685260,10098275]},{texure:"tail",frame:"58",colors:[16773923,16763395,16733187]},{texure:"tail",frame:"55",colors:[16750529,14685260,10098275]},{texure:"tail",frame:"58",colors:[16773923,16763395,16733187]},{texure:"tail",frame:"55",colors:[16763395,16733187,10564403]},{texure:"tail",frame:"55",colors:[16645888,3728717,2200319,591232]},{texure:"tail",frame:"46",colors:[16773923,16763395,16733187]},{texure:"tail",frame:"59",colors:[4699647,1270751,403517]},{texure:"tail",frame:"59",colors:[16383312,8777543,48470]},{texure:"tail",frame:"46",colors:[8840703,6013176,33225]},{texure:"tail",frame:"58",colors:[16504530,13519295,10895045]},{texure:"tail",frame:"58",colors:[16504530,13519295,10895045]},{texure:"tail",frame:"59",colors:[16773923,16763395,16733187]},{texure:"tail",frame:"59",colors:[16773923,16763395,16733187]},{texure:"tail",frame:"59",colors:[16750529,16734296,14685260,10098275]},{texure:"tail",frame:"40",colors:[15219220,8982285,6489606]},{texure:"tail",frame:"46",colors:[16763395,16733187,10564403]},{texure:"tail",frame:"5",colors:[4699647,1270751,2049680,2300245]},{texure:"tail",frame:"19",colors:[16763395,16733187,10564403]},{texure:"tail",frame:"59",colors:[16760335,16391694,9175040]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"58",colors:[16383312,8777543,48470]},{texure:"tail",frame:"5",colors:[16383312,8777543,48470]},{texure:"tail",frame:"55",colors:[16504530,13519295,10895045]},{texure:"tail",frame:"59",colors:[16750529,16734296,14685260,10098275]},{texure:"tail",frame:"59",colors:[3728717,5551157,3641911]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[3728717,6009624,2849291,1336150]},{texure:"tail",frame:"59",colors:[3728717,6009624,2849291,1336150]},{texure:"tail",frame:"19",colors:[16773923,16763395,16733187]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"34",colors:[8840703,6013176,33225]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[16750529,16734296,14685260,10098275]},{texure:"tail",frame:"59",colors:[3728717,5551157,3641911]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[3728717,6009624,2849291,1336150]},{texure:"tail",frame:"59",colors:[3728717,6009624,2849291,1336150]},{texure:"tail",frame:"59",colors:[16760335,16391694,9175040]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"19",colors:[12185053,8899513,5676458,5733766]},{texure:"tail",frame:"10",colors:[16763395,16733187,10564403]},{texure:"tail",frame:"17",colors:[8777543,48470,754775]},{texure:"tail",frame:"49",colors:[4699647,1270751,2049680,2300245]},{texure:"tail",frame:"31",colors:[4699647,1270751,403517]},{texure:"tail",frame:"5",colors:[15753874,13775721,10233165]},{texure:"tail",frame:"59",colors:[3728717,6009624,2849291,1336150]},{texure:"tail",frame:"16",colors:[15615296,13052993,8393526,2954028]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[3728717,6009624,2849291,1336150]},{texure:"tail",frame:"59",colors:[3728717,6009624,2849291,1336150]},{texure:"tail",frame:"38",colors:[4384420,174248,99203]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[3728717,6009624,2849291,1336150]},{texure:"tail",frame:"59",colors:[3728717,6009624,2849291,1336150]},{texure:"tail",frame:"59",colors:[16760335,16391694,9175040]},{texure:"tail",frame:"37",colors:[8840703,6013176,33225]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[3728717,6009624,2849291,1336150]},{texure:"tail",frame:"18",colors:[16504530,13519295,10895045]},{texure:"tail",frame:"3",colors:[8777543,48470,754775]},{texure:"tail",frame:"48",colors:[13792901,10372996,6698111,3616875]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[16772020,16760745,16755884]},{texure:"tail",frame:"59",colors:[16645888,10288942,3728717]},{texure:"tail",frame:"59",colors:[16504530,15831223,13519295,10895045]},{texure:"tail",frame:"59",colors:[16711680,3997696,0]},{texure:"tail",frame:"59",colors:[15831223,13519295,10895045]},{texure:"tail",frame:"25",colors:[15219220,8982285,6489606]},{texure:"tail",frame:"59",colors:[16761600,15491338,10750524,7014472]},{texure:"tail",frame:"59",colors:[16711680,9765121,3997696,0]},{texure:"tail",frame:"59",colors:[16753920,16776960,32768,255,4915330]},{texure:"tail",frame:"59",colors:[16710055,16433683,16219681]},{texure:"tail",frame:"37",colors:[8840703,6013176,33225]},{texure:"tail",frame:"3",colors:[8840703,6013176,33225]},{texure:"tail",frame:"59",colors:[3728717,5551157,3641911]},{texure:"tail",frame:"59",colors:[16772020,16760745,16755884]},{texure:"tail",frame:"59",colors:[16645888,10288942,3728717]},{texure:"tail",frame:"59",colors:[16504530,15831223,13519295,10895045]},{texure:"tail",frame:"59",colors:[16711680,3997696,0]},{texure:"tail",frame:"59",colors:[15831223,13519295,10895045]},{texure:"tail",frame:"59",colors:[16753097,16337042,15075685]},{texure:"tail",frame:"59",colors:[16761600,15491338,10750524,7014472]},{texure:"tail",frame:"59",colors:[16711680,9765121,3997696,0]},{texure:"tail",frame:"59",colors:[16753920,16776960,32768,255,4915330]},{texure:"tail",frame:"59",colors:[16710055,16433683,16219681]},{texure:"tail",frame:"55",colors:[15219220,8982285,6489606]},{texure:"tail",frame:"59",colors:[16750529,16734296,14685260,10098275]},{texure:"tail",frame:"59",colors:[3728717,5551157,3641911]},{texure:"tail",frame:"59",colors:[16772020,16760745,16755884]},{texure:"tail",frame:"59",colors:[16645888,10288942,3728717]},{texure:"tail",frame:"59",colors:[16504530,15831223,13519295,10895045]},{texure:"tail",frame:"59",colors:[16711680,3997696,0]},{texure:"tail",frame:"59",colors:[15831223,13519295,10895045]},{texure:"tail",frame:"59",colors:[16753097,16337042,15075685]},{texure:"tail",frame:"59",colors:[16761600,15491338,10750524,7014472]},{texure:"tail",frame:"59",colors:[16711680,9765121,3997696,0]},{texure:"tail",frame:"59",colors:[16753920,16776960,32768,255,4915330]},{texure:"tail",frame:"59",colors:[16710055,16433683,16219681]},{texure:"tail",frame:"59",colors:[5152573,1986856,1645081]},{texure:"tail",frame:"59",colors:[16750529,16734296,14685260,10098275]},{texure:"tail",frame:"59",colors:[3728717,5551157,3641911]}];class p{static setString(e,t){try{localStorage.setItem(e,t)}catch(t){console.error(`Error saving ${e}:`,t)}}static getString(e){try{const t=localStorage.getItem(e);if(null!==t)return t}catch(t){console.error(`Error load ${e}:`,t)}return"0"}static setNumber(e,t){try{localStorage.setItem(e,t.toString())}catch(t){console.error(`Error saving ${e}:`,t)}}static getInt(e){try{const t=localStorage.getItem(e);if(null!==t)return parseInt(t)}catch(t){console.error(`Error load ${e}:`,t)}return 0}static getFloat(e){try{const t=localStorage.getItem(e);if(null!==t)return parseFloat(t)}catch(t){console.error(`Error load ${e}:`,t)}return 0}static setArray(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(e){console.error("Error saving array:",e)}}static getArray(e){try{const t=localStorage.getItem(e);if(null!==t)return JSON.parse(t)}catch(e){console.error("Error retrieving array:",e)}return[]}static save(e,t){try{const s=JSON.stringify(t);localStorage.setItem(e,s)}catch(t){console.error(`Error saving ${e}:`,t)}}static load(e){try{const t=localStorage.getItem(e);if(null!==t)return JSON.parse(t)}catch(t){console.error(`Error loading ${e}:`,t)}return null}static deleteAll(){localStorage.clear()}}var x,b;!function(e){e.SOUND="sound",e.VIBRATION="vibration",e.NIGHT_MODE="night_mode"}(x||(x={})),function(e){e.PLAYER_DATA="player-data"}(b||(b={}));const S={highScore:0,stars:0,settings:{sound:!0,vibration:!1,nightMode:!1},skins:{current:0,unlocked:[0]},challenges:{time:0,score:0,bounce:0,"no-aim":0}};class y{static getPlayerData(){try{const e=p.load(b.PLAYER_DATA);if(e)return e}catch(e){console.error("Error retrieving player high score:",e)}return S}static savePlayerData(e){p.save(b.PLAYER_DATA,e)}static getStars(){return this.getPlayerData().stars}static getHighScore(){return this.getPlayerData().highScore}static getCurrentSkin(){return this.getPlayerData().skins.current}static getUnlockedSkins(){return this.getPlayerData().skins.unlocked}static setSettings(e,t){const s=this.getPlayerData();switch(e){case x.SOUND:s.settings.sound=t;break;case x.VIBRATION:s.settings.vibration=t;break;case x.NIGHT_MODE:s.settings.nightMode=t}this.savePlayerData(s)}static setChallengeLevel(e,t){const s=this.getPlayerData();switch(e){case n.TIME:s.challenges.time=t;break;case n.SCORE:s.challenges.score=t;break;case n.BOUNCE:s.challenges.bounce=t;break;case n.NO_AIM:s.challenges["no-aim"]=t}this.savePlayerData(s)}static getChallengeLevel(e){const t=this.getPlayerData();switch(e){case n.TIME:return t.challenges.time;case n.SCORE:return t.challenges.score;case n.BOUNCE:return t.challenges.bounce;case n.NO_AIM:return t.challenges["no-aim"]}}}class f{static init(e){f.scene=e,f.popUpText=e.add.bitmapText(0,0,"triomphe","",40).setTint(16485157).setDepth(-3).setOrigin(.5).setAlpha(0)}static create(e){this.popUpQueue.push(e)}static playTweenQueue(e,t){const s=this.popUpQueue.shift();s&&(this.popUpText.x=e,this.popUpText.y=t,this.popUpText.setText(s.text).setTint(s.color),this.scene.add.tween({targets:this.popUpText,alpha:{value:1,duration:250,yoyo:!0},y:{value:t-20,duration:300,ease:"Back.out"},onComplete:()=>{this.playTweenQueue(e,t)}}))}}f.popUpQueue=[];class C{static init(e){this.scene=e}static playReleaseSound(){this.scene.sound.play("release")}static playGameOverSound(){this.scene.sound.play("game-over",{name:"a",start:.4})}static playWallHitSound(){this.scene.sound.play("wall-hit")}static playStarSound(){this.scene.sound.play("star")}static playComboHitSound(){this.scene.sound.play("combo-hit")}static playComboShootSound(){this.scene.sound.play("combo-shoot")}static playComboStartSound(){this.scene.sound.play("combo-start")}static playNoteSound(e){this.scene.sound.play(`${e}`)}static playTimerBuzzSound(){this.scene.sound.play("timer-buzz")}}class k{static init(){this.bounce=0,this.perfect=0,this.combo=1,this.previousCombo=1,this.emitter=new Phaser.Events.EventEmitter}static getBounce(){return this.bounce}static setBounce(e){this.bounce=e}static getCombo(){return this.combo}static setCombo(e){this.combo=e,this.emitter.emit("combo-changed",e)}static handlePopup(){const e=k.getCombo();e>=4&&(4===e?C.playComboStartSound():C.playComboHitSound()),k.getBounce()>0&&f.create({text:"Bounce"+(k.getBounce()>1?" x"+k.getBounce():""),color:3187455}),this.previousCombo>0&&e>this.previousCombo&&f.create({text:"Perfect"+(e-1>1?" x"+(e-1):""),color:16485157}),this.previousCombo=e}}class E{static init(){this.emitter=new Phaser.Events.EventEmitter,this.currentSkin=y.getCurrentSkin(),this.unlockedSkins=y.getUnlockedSkins(),0===this.unlockedSkins.length&&(this.unlockedSkins=[0])}static unlockSkin(e){this.unlockedSkins.push(e);const t=y.getPlayerData();t.skins.unlocked=this.unlockedSkins,y.savePlayerData(t)}static changeSkin(e){this.currentSkin=e;const t=y.getPlayerData();t.skins.current=e,y.savePlayerData(t),this.emitter.emit("skin-changed",e)}static getCurrentSkinColors(){return m[this.currentSkin].colors}static getCurrentSkin(){return this.currentSkin}static getUnlockedSkins(){return this.unlockedSkins}}E.unlockedSkins=[];class B{static HexToRRB(e){return Phaser.Display.Color.IntegerToRGB(e)}static RGBtoHex(e){return(e.r<<16)+(e.g<<8)+e.b}static Shade(e,t){return e.r=Math.floor(e.r*(1-t)),e.g=Math.floor(e.g*(1-t)),e.b=Math.floor(e.b*(1-t)),e}}const v=3e-5;class P extends Phaser.Physics.Arcade.Sprite{constructor(e){super(e.scene,e.x,e.y,e.texture,e.frame),this.onComboChanged=e=>{if(0===e)this.specialParticle.stop(),this.smokeParticle.stop();else if(3===e)this.smokeParticle.destroy(),this.addSmokeParticle();else if(e>=4){4===e&&(this.smokeParticle.destroy(),this.addSmokeParticle(),this.fireDustParticle.start(),this.specialParticle.start()),y.getPlayerData().settings.vibration&&window.navigator.vibrate(300);const t=B.HexToRRB(E.getCurrentSkinColors()[0]);this.scene.cameras.main.flash(200,t.r,t.g,t.b),this.scene.cameras.main.shake(200,.003)}},this.onSkinChanged=e=>{this.setFrame(e),this.specialParticle.destroy(),this.smokeParticle.destroy(),this.addSmokeParticle(),this.addSpecialParticle(),k.getCombo()<3&&this.smokeParticle.stop(),k.getCombo()<4&&this.specialParticle.stop()},this.addSmokeParticle(),this.addSpecialParticle(),this.addFireDustParticle(),this.smokeParticle.stop(),this.fireDustParticle.stop(),this.specialParticle.stop(),k.setCombo(1),e.scene.add.existing(this),e.scene.physics.add.existing(this),E.emitter.on("skin-changed",this.onSkinChanged),k.emitter.on("combo-changed",this.onComboChanged)}shoot(e){this.setVelocity(e.x,e.y),this.setBounce(.7),this.setGravityY(2e3),C.playReleaseSound(),k.getCombo()>3&&C.playComboShootSound()}addSpecialParticle(){this.specialParticle=this.scene.add.particles(0,0,m[E.getCurrentSkin()].texure,{color:E.getCurrentSkinColors(),colorEase:"quad.out",lifespan:700,angle:{min:0,max:360},rotate:{min:0,max:360},scale:{start:.35,end:0},speed:{min:10,max:30},frequency:40,frame:m[E.getCurrentSkin()].frame}),this.specialParticle.startFollow(this),this.specialParticle.setDepth(-4)}addFireDustParticle(){this.fireDustParticle=this.scene.add.particles(0,0,"circle",{color:[16773923,16763395,16733187],alpha:{start:1,end:0,ease:"Quad.in"},angle:{min:-135,max:-45},colorEase:"quad.out",lifespan:600,scale:{start:.3,end:.5,ease:"Quad.in"},speed:{min:100,max:150},duration:500,frequency:80}),this.fireDustParticle.stop(),this.fireDustParticle.startFollow(this,0,-20)}addSmokeParticle(){const e=E.getCurrentSkinColors()[2],t=B.HexToRRB(e),s=3===k.getCombo()?[16777215,15790320,8947848]:[B.RGBtoHex(B.Shade(t,.4)),B.RGBtoHex(B.Shade(t,.5)),B.RGBtoHex(B.Shade(t,.6))];this.smokeParticle=this.scene.add.particles(0,0,"circle",{color:s,alpha:{start:.8,end:0,ease:"sine.out"},colorEase:"quad.out",lifespan:1e3,angle:{min:0,max:360},rotate:{min:0,max:360},scale:{start:.6,end:.8,ease:"quad.out"},speed:{min:50,max:60},frequency:60}),this.smokeParticle.startFollow(this),this.smokeParticle.setDepth(-5)}update(e,t){if(this.body){const e=this.body.velocity.x;e>10?this.rotation+=v*Math.max(600,this.body.velocity.length())*t:e<-10&&(this.rotation-=v*Math.max(600,this.body.velocity.length())*t)}}}var A;class G{static init(){this.curScore=0,this.highScore=y.getHighScore(),this.emitter=new Phaser.Events.EventEmitter}static getScore(){return this.curScore}}A=G,G.updateScore=e=>{if(A.curScore=e,A.curScore>A.highScore){A.highScore=A.curScore;const e=y.getPlayerData();e.highScore=A.curScore,y.savePlayerData(e),A.emitter.emit("high-score-updated",A.highScore)}A.emitter.emit("score-updated",A.curScore)};class T{static init(){this.currentStar=y.getStars(),this.emitter=new Phaser.Events.EventEmitter}static updateStar(e){this.currentStar=e,this.emitter.emit("star-updated",e);const t=y.getPlayerData();t.stars=e,y.savePlayerData(t)}static increaseStar(){this.updateStar(this.currentStar+1)}static getCurrentStar(){return this.currentStar}}class w extends Phaser.Physics.Arcade.Sprite{constructor(e){super(e.scene,e.x,e.y,"star"),this.isActive=!0,e.ball&&(this.ball=e.ball,this.scene.physics.add.existing(this),this.scene.physics.add.overlap(this.ball,this,(()=>{this.isActive&&(this.isActive=!1,C.playStarSound(),T.increaseStar(),this.scene.add.tween({targets:this,scale:{value:0},duration:300,ease:"Back.in",onComplete:()=>{this.scale=.3,this.alpha=0}}))})))}}const L=[[0,50],[65,-10],[-65,-10],[45,25],[-45,25]],O=1800;class N extends Phaser.GameObjects.Container{constructor(e,t,s,a){super(e,s,a),this.otherCirc=[],this.hasBall=!1,this.hadBall=!1,this.shootVelocity=new Phaser.Math.Vector2(0,0),this.emitter=new Phaser.Events.EventEmitter,e.add.existing(this),this.ball=t,this.createBasketObjects(e),this.registerOverlapEvent(e),this.registerDragEvents(e),this.isAvaliable=!0}createBasketObjects(e){this.basketTopSprite=e.add.sprite(this.x,this.y,"basket",0).setScale(.4).setOrigin(.5,1.5).setDepth(-3),this.basketBottomSprite=e.add.sprite(0,0,"basket",1).setScale(.4),this.basketEffectSprite=e.add.sprite(0,0,"e3").setScale(.4).setAlpha(0),this.netSprite=e.add.sprite(0,0,"net").setScale(.4).setOrigin(.5,0),this.centerCirc=e.physics.add.sprite(0,15,"").setCircle(20).setOffset(-4,-4).setAlpha(0);for(let t=0;t<5;t++)this.otherCirc[t]=e.physics.add.sprite(L[t][0],L[t][1],"").setCircle(6).setOffset(10,10).setAlpha(0),this.add(this.otherCirc[t]),e.physics.add.existing(this.otherCirc[t]),this.otherCirc[t].body.setImmovable(!0).setBounce(0).moves=!1,1===t||2===t?e.physics.add.collider(this.otherCirc[t],this.ball,(()=>{this.hasBall||k.setCombo(0)})):e.physics.add.collider(this.otherCirc[t],this.ball);this.add(this.netSprite),this.add(this.basketBottomSprite),this.add(this.centerCirc),this.add(this.basketEffectSprite),e.physics.add.existing(this.centerCirc)}createStar(e){this.star||(this.star=new w({scene:e,x:0,y:-70,ball:this.ball}).setScale(.3),this.add(this.star)),this.star.setAlpha(1),this.star.isActive=!0}setMoveable(e,t){this.moveTween&&this.moveTween.destroy();const s={targets:this,ease:"Sine.inout",duration:2e3,yoyo:!0,repeat:-1},a=new Phaser.Math.Vector2(0,0);if("none"!==e){switch(e){case"right":s.x=this.x+t,a.x=this.x+t,a.y=this.y;break;case"left":s.x=this.x-t,a.x=this.x-t,a.y=this.y;break;case"up":s.y=this.y-t,a.x=this.x,a.y=this.y-t;break;case"down":s.y=this.y+t,a.x=this.x,a.y=this.y+t}this.moveTween=this.scene.add.tween(s),g.drawLine(new Phaser.Math.Vector2(this.x,this.y),a,8),this.moveTween.play()}}registerOverlapEvent(e){e.physics.add.overlap(this.centerCirc,this.ball,(()=>{!this.hasBall&&this.isAvaliable&&(this.isAvaliable=!1,this.hasBall=!0,this.ball.setBounce(0),this.emitter.emit("onHasBall",this),this.hadBall||(this.hadBall=!0,this.changeBasketTexture(1)),this.animateBasketEffect(),this.setMoveable("none",0))}))}registerDragEvents(e){e.input.on("dragstart",(e=>{c.getCurrentState()!==l.CHALLENGE_READY&&c.getCurrentState()!==l.CHALLENGE_COMPLETE&&c.getCurrentState()!==l.GAME_OVER&&(this.hasBall&&(this.dragStartPos=new Phaser.Math.Vector2(e.x,e.y)),c.getCurrentState()===l.READY&&c.updateGameState(l.PLAYING,this.scene))})),e.input.on("drag",(e=>{c.getCurrentState()!==l.GAME_OVER&&this.hasBall&&this.dragStartPos&&this.handleDragMovement(e)})),e.input.on("dragend",(()=>{c.getCurrentState()!==l.GAME_OVER&&this.hasBall&&this.shootVelocity.length()>100&&(this.emitter.emit("onDragEnd",this),this.hasBall=!1,this.otherCirc[0].y=50,e.add.tween({targets:this.netSprite,scaleY:.4,duration:300,ease:"Back.out"}),this.ball.shoot(this.shootVelocity),g.clearTrajectoryLine(),this.scene.time.delayedCall(300,(()=>{this.isAvaliable=!0})),c.getCurrentState()===l.CHALLENGE_PLAYING&&e.add.tween({targets:this,rotation:0,duration:300,ease:"Back.out",delay:150}))}))}handleDragMovement(e){this.ball.setGravityY(0),this.ball.setVelocity(0),this.dragPos=new Phaser.Math.Vector2(e.x,e.y),this.shootVelocity=new Phaser.Math.Vector2(7*(this.dragStartPos.x-this.dragPos.x),7*(this.dragStartPos.y-this.dragPos.y));const t=Math.min(this.shootVelocity.length(),O);if(this.shootVelocity=new Phaser.Math.Vector2(t*Math.cos(this.shootVelocity.angle()),t*Math.sin(this.shootVelocity.angle())),this.shootVelocity.length()>100&&(this.rotation=this.shootVelocity.angle()+Math.PI/2,this.netSprite.scaleY=t/O*.25+.4,this.otherCirc[0].y=t/O*25+50,this.ball.x=-Math.cos(this.shootVelocity.angle())*(t/O*25+13)+this.x,this.ball.y=-Math.sin(this.shootVelocity.angle())*(t/O*25+13)+this.y,this.shootVelocity.length()>500)){if(c.getCurrentState()===l.CHALLENGE_PLAYING&&"no-aim"===this.scene.registry.get("challenge").name)return;g.drawTrajectoryLine(new Phaser.Math.Vector2(this.ball.x,this.ball.y),this.shootVelocity,2e3,Math.min(this.shootVelocity.length()/O*2,1))}}animateBasketEffect(){this.basketEffectSprite.setAlpha(1).setScale(.2),this.scene.add.tween({targets:this,rotation:{value:0,duration:300},ease:"Back.out"}),this.scene.add.tween({targets:this.basketEffectSprite,alpha:{value:0,duration:300},scale:{value:1,duration:300},ease:"Quad.out"}),this.scene.add.tween({targets:this.ball,x:{value:this.x,duration:200},y:{value:this.y+25,duration:100},ease:"Quad.out"}),this.scene.add.tween({targets:this.otherCirc[0],y:{value:this.otherCirc[0].y+15,duration:100,yoyo:!0},ease:"Quad.out"}),this.scene.add.tween({targets:this.netSprite,scaleY:{value:.5,duration:100},yoyo:!0,ease:"Quad.out"})}changeBasketTexture(e){this.basketTopSprite.setTexture("basket",2*e),this.basketBottomSprite.setTexture("basket",2*e+1)}update(){this.basketTopSprite.rotation=this.rotation,this.basketTopSprite.x=this.x,this.basketTopSprite.y=this.y,this.basketTopSprite.setScale(.4*this.scale)}}class D extends Phaser.Physics.Arcade.Sprite{constructor(e){super(e.scene,e.x,e.y,"bouncer"),this.ball=e.ball,this.scene.add.existing(this).setScale(.35),this.scene.physics.add.existing(this,!1),this.defaultScale=this.scale,this.setCircle(100),this.body&&(this.body.immovable=!0),this.scene.physics.add.collider(this.ball,this,(()=>{k.setBounce(k.getBounce()+1),this.ball.body&&(this.ball.setVelocity(1.5*this.ball.body.velocity.x,1.5*this.ball.body.velocity.y),this.scale=this.defaultScale,this.scene.add.tween({targets:this,scale:1.1*this.defaultScale,duration:50,yoyo:!0,ease:"Quad.out"}))}))}setActive(e){return this.body&&(this.body.enable=e),this}}class I extends Phaser.GameObjects.NineSlice{constructor(e){super(e.scene,e.x,e.y,"mini-wall",0,25,309,10,10,100,100),this.ball=e.ball,this.scene.add.existing(this).setScale(.65),this.scene.physics.add.existing(this,!1),this.body&&(this.physic=this.body,this.physic.immovable=!0),this.scene.physics.add.collider(this.ball,this,(()=>{k.setBounce(k.getBounce()+1)}))}setActive(e){return this.physic.enable=e,this}}const M=[[-Math.PI/2,Math.PI/2]];class R extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y),e.scene.add.existing(this),this.ball=e.ball,this.createSprite(e.scene),this.createCollider(e.scene)}createSprite(e){this.shieldSprite=e.add.sprite(0,0,"shield").setScale(1),this.radius=this.shieldSprite.displayWidth/2-15,this.add(this.shieldSprite)}createCollider(e){for(let t=0;t<M.length;t++){const s=(M[t][1]-M[t][0])/11;for(let a=0;a<12;a++){const i=this.radius*Math.cos(s*a+M[t][0]),r=this.radius*Math.sin(s*a+M[t][0]),n=e.physics.add.sprite(i,r,"").setCircle(10).setOffset(10,10).setAlpha(0);this.add(n),e.physics.add.existing(n),n.body.setImmovable(!0).setBounce(0).moves=!1,e.physics.add.collider(n,this.ball)}}}update(e,t){this.rotation+=.0015*t}}class U{static Float(e,t){return Math.random()*(t-e)+e}static Int(e,t){return Math.floor(Math.random()*(t-e+1)+e)}static Percent(e){return this.Float(0,100)<=e}}class V extends Phaser.GameObjects.Container{constructor(e,t){super(e.scene,e.x,e.y),this.baskets=[],this.handleBallTouch=e=>{if(e.hadBall)return void k.setBounce(0);g.clearNormalLine(),this.generateNextBasket(e),this.deadZone.y=e.y+450,k.setCombo(k.getCombo()+1),k.handlePopup();const t=Math.min(k.getCombo(),10)*(k.getBounce()>0?2:1);C.playNoteSound(Math.min(k.getCombo(),10)),G.updateScore(G.getScore()+t),f.create({text:`+${t}`,color:13652778}),f.playTweenQueue(e.x,e.y-50),k.setBounce(0)},e.scene.add.existing(this),this.ball=t,this.ballSpawnPos=new Phaser.Math.Vector2(this.ball.x,this.ball.y),this.camera=this.scene.cameras.main,this.createObstacles(),this.createDeadZone(),this.createBaskets(),this.add(this.baskets),this.add([this.baskets[0].basketTopSprite,this.baskets[1].basketTopSprite]),this.add([this.bouncer,this.miniWall,this.shield]),this.add(this.deadZone)}createDeadZone(){this.deadZone=this.scene.add.rectangle(300,this.scene.scale.height,r,0,0,0),this.scene.physics.add.existing(this.deadZone),this.scene.physics.add.overlap(this.deadZone,this.ball,(()=>{c.getCurrentState()===l.PLAYING&&(C.playGameOverSound(),0===G.getScore()?(this.ball.setPosition(this.ballSpawnPos.x,this.ballSpawnPos.y-200).setVelocity(0).setRotation(0),this.scene.add.tween({targets:this.baskets[0],rotation:0,duration:300,ease:"Back.out"})):(c.updateGameState(l.GAME_OVER,this.scene),this.camera.stopFollow()))}))}createBaskets(){this.baskets[0]=new N(this.scene,this.ball,156,.73*this.scene.scale.height),this.baskets[1]=new N(this.scene,this.ball,450,.63*this.scene.scale.height),this.ball.y=this.baskets[0].y,this.baskets[0].hadBall=!0,this.baskets[0].changeBasketTexture(1),this.targetBasket=this.baskets[1],this.baskets.forEach((e=>{e.emitter.on("onHasBall",this.handleBallTouch)}))}createObstacles(){this.miniWall=new I({scene:this.scene,x:300,y:100,ball:this.ball}).setActive(!1).setScale(0),this.bouncer=new D({scene:this.scene,x:300,y:100,ball:this.ball}).setActive(!1).setScale(0),this.shield=new R({scene:this.scene,x:800,y:500,ball:this.ball})}generateNextBasket(e){const t=this.baskets.indexOf(e),s=this.baskets[1-t];this.targetBasket=s,this.targetBasket.changeBasketTexture(0),this.targetBasket.hadBall=!1,this.targetBasket.y=U.Int(e.y-450,e.y-150),0===t?(this.targetBasket.x=U.Int(360,480),this.targetBasket.rotation=U.Float(-.5,0)):(this.targetBasket.x=U.Int(120,240),this.targetBasket.rotation=U.Float(0,.5)),U.Percent(20)&&this.targetBasket.createStar(this.scene),this.targetBasket.scale=.01,this.scene.add.tween({targets:this.targetBasket,scale:1,duration:300,ease:"Back.out"}),this.generateObstacles()}generateObstacles(){if(this.miniWall.setActive(!1).setScale(0),this.bouncer.setActive(!1).setScale(0),this.shield.setScale(.001).setPosition(800,0),U.Percent(10)){const e=U.Percent(50),t=this.targetBasket.x>300?U.Float(-300,-200):U.Float(200,300);e?this.targetBasket.setMoveable("right",t):this.targetBasket.setMoveable("up",t)}else U.Percent(10)?(this.miniWall.setActive(!0).y=this.targetBasket.y-50,this.scene.add.tween({targets:this.miniWall,scale:.65,duration:300,ease:"Back.out"}),this.miniWall.x=this.targetBasket.x+(U.Percent(50)?100:-100)):U.Percent(10)?(this.bouncer.setActive(!0).y=this.targetBasket.y-200,this.bouncer.x=this.targetBasket.x,this.scene.add.tween({targets:this.bouncer,scale:.35,duration:300,ease:"Back.out"}),this.targetBasket.rotation=0):U.Percent(10)&&(this.shield.setPosition(this.targetBasket.x,this.targetBasket.y),this.scene.add.tween({targets:this.shield,scale:.65,duration:300,ease:"Back.out"}),this.targetBasket.rotation=0)}update(e,t){for(const e of this.baskets)e.update();this.shield.update(e,t)}}class H extends Phaser.GameObjects.Container{constructor(e){if(super(e.scene,e.x,e.y),this.onGameStateChanged=e=>{if(e===l.CHALLENGE_READY){const{name:e,level:t}=this.scene.registry.get("challenge");this.rect.fillColor=h[e].color,this.title.setText(`CHALLENGE ${t}`),"no-aim"!==e?H.goal.setText(this.scene.registry.get("goal")):H.goal.setAlpha(0)}},e.scene.add.existing(this),this.rexUI=new u.Z(e.scene,e.scene.plugins,"hud"),this.createRect(),this.createTitle(),this.createIcon(),this.createGoal(),this.createAttemptSizer(),this.add(this.rect),this.add(this.title),this.add(this.icon),this.add(H.goal),this.add(H.attemptSizer),c.getCurrentState()===l.CHALLENGE_READY){const{name:e,level:t}=this.scene.registry.get("challenge");this.rect.fillColor=h[e].color,this.title.setText(`CHALLENGE ${t}`),"no-aim"===e?(H.goal.setAlpha(0).setOrigin(.5),this.icon.setAlpha(0)):"time"===e?(H.attemptSizer.setAlpha(0),H.goal.setOrigin(.5),this.icon.setAlpha(0)):(this.icon.setTexture(`${e}-icon`),H.attemptSizer.setAlpha(0),H.goal.setText(this.scene.registry.get("goal")).setOrigin(0,.5))}c.emitter.on("game-state-changed",this.onGameStateChanged)}createRect(){this.rect=this.scene.add.rectangle(0,0,r,.07*this.scene.scale.height,16777215).setOrigin(0,0)}createTitle(){this.title=this.scene.add.bitmapText(66,.031*this.scene.scale.height,"triomphe","CHALLENGE",20).setOrigin(0,.5)}createIcon(){this.icon=this.scene.add.image(270,.032*this.scene.scale.height,"score-icon").setScale(.5)}createGoal(){H.goal=this.scene.add.bitmapText(300,.027*this.scene.scale.height,"triomphe","",32).setOrigin(.5)}createAttemptSizer(){H.attemptImages=[],H.attemptSizer=this.rexUI.add.fixWidthSizer({x:300,y:.034*this.scene.scale.height,width:r,align:"center"});for(let e=0;e<3;e++){const e=this.scene.add.image(0,0,"attempt-active").setScale(.7);H.attemptSizer.add(e,{padding:{left:5,right:5}}),H.attemptImages.push(e)}H.attemptSizer.layout()}static setGoal(e){H.goal.setText(e)}static setAttempts(e){this.attemptImages[e].setTexture("attempt-inactive")}destroy(e){super.destroy(e),c.emitter.off("game-state-changed",this.onGameStateChanged)}}class _{constructor(e,t,s){this.duration=e,this.current=e,this.active=t,this.onCompleteCallback=s}setDuration(e){this.duration=e,this.current=e}setActive(e){this.active=e}tick(e){this.active&&this.current>=0&&(this.current-=e/1e3,H.setGoal(this.current.toFixed(2)),this.current<=0&&this.onCompleteCallback&&(H.setGoal("0.00"),this.onCompleteCallback()))}reset(){this.current=this.duration,H.setGoal(this.current.toFixed(2))}}class Y extends Phaser.GameObjects.Container{constructor(e,t){super(e.scene,e.x,e.y),this.handleBallTouch=e=>{if(e.hadBall)return this.mode===n.TIME&&0===this.currentHoops&&e===this.initialBasket&&(this.timer.reset(),this.timer.setActive(!1)),void k.setBounce(0);this.currentHoops++,this.ballSpawnPos=new Phaser.Math.Vector2(e.x,e.y),this.deadZone.y=e.y+500,k.setCombo(k.getCombo()+1),k.handlePopup();const t=Math.min(k.getCombo(),10)*(k.getBounce()>0?2:1);switch(C.playNoteSound(Math.min(k.getCombo(),10)),G.updateScore(G.getScore()+t),f.create({text:`+${t}`,color:13652778}),f.playTweenQueue(e.x,e.y-50),this.mode){case n.SCORE:this.currentGoal+=t;break;case n.BOUNCE:this.currentGoal+=k.getBounce();break;case n.NO_AIM:this.currentGoal+=1}if(this.mode!==n.TIME&&H.setGoal(`${this.currentGoal}/${this.goal}`),k.setBounce(0),e===this.targetBasket)if(this.timer.setActive(!1),this.mode===n.TIME||this.currentGoal>=this.goal){c.updateGameState(l.CHALLENGE_COMPLETE,this.scene);const{level:e}=this.scene.registry.get("challenge");y.setChallengeLevel(this.mode,e)}else C.playGameOverSound(),c.updateGameState(l.GAME_OVER,this.scene)},e.scene.add.existing(this),this.ball=t,this.initializeVariables(),this.createDeadZone(),this.add(this.deadZone)}initializeVariables(){this.camera=this.scene.cameras.main,this.attempts=1,this.baskets=[],this.currentHoops=0,this.currentGoal=0;const{name:e}=this.scene.registry.get("challenge");this.mode=e,this.timer=new _(-1,!1,(()=>{c.getCurrentState()!==l.CHALLENGE_COMPLETE&&(C.playTimerBuzzSound(),c.updateGameState(l.GAME_OVER,this.scene),this.camera.stopFollow())})),this.mode===n.NO_AIM&&(this.attempts=3)}createDeadZone(){this.deadZone=this.scene.add.rectangle(300,this.scene.scale.height,r,0,0,0),this.scene.physics.add.existing(this.deadZone),this.scene.physics.add.overlap(this.deadZone,this.ball,(()=>{c.getCurrentState()===l.CHALLENGE_PLAYING&&(C.playGameOverSound(),0===G.getScore()?(this.ball.setPosition(this.ballSpawnPos.x,this.ballSpawnPos.y-200).setVelocity(0).setRotation(0),this.timer.reset(),this.timer.setActive(!1)):this.attempts>1?(this.attempts=this.attempts-1,H.setAttempts(this.attempts),this.ball.setPosition(this.ballSpawnPos.x,this.ballSpawnPos.y-200).setVelocity(0).setRotation(0)):(H.setAttempts(0),c.updateGameState(l.GAME_OVER,this.scene),this.camera.stopFollow()))}))}loadChallengeLevel(e){const t=this.scene.make.tilemap({key:`${e.name}-${e.level}`}),s=t.getObjectLayer("objects");if(!s)return;const a=s.objects,i=this.scene.scale.height-t.height*t.tileHeight;this.goal=s.properties[0].value,this.mode===n.TIME&&this.timer.setDuration(this.goal),this.scene.registry.set("goal",`0/${this.goal}`),a.forEach((e=>{const t=e.x+e.width/2,s=i+e.y,a=Phaser.Math.DegToRad(e.rotation);if("basket"===e.type){const i=new N(this.scene,this.ball,t,s);i.rotation=a,i.setMoveable(e.properties[0].value,e.properties[1].value),"targetbasket"===e.name?this.targetBasket=i:"initialbasket"===e.name&&(i.hadBall=!0,i.changeBasketTexture(1),this.initialBasket=i),this.add(i),this.baskets.push(i),i.emitter.on("onDragEnd",(()=>{"time"===this.scene.registry.get("challenge").name&&this.timer.setActive(!0)})),i.emitter.on("onHasBall",this.handleBallTouch)}else"bouncer"===e.type?this.add(new D({scene:this.scene,x:t,y:s,ball:this.ball}).setActive(!0)):"miniwall"===e.type?this.add(new I({scene:this.scene,x:t,y:s,ball:this.ball}).setActive(!0)):"ball"===e.type&&(this.ball.x=t,this.ball.y=s,this.ballSpawnPos=new Phaser.Math.Vector2(this.ball.x,this.ball.y))}))}destroy(e){super.destroy(e),this.timer.setActive(!1)}update(e,t){this.baskets.forEach((e=>{e.update()})),this.mode===n.TIME&&this.timer.tick(t)}}class z extends i().Scene{constructor(){super("game"),this.walls=[]}init(){g.init(this),E.init(),f.init(this),C.init(this),k.init(),G.init(),T.init()}create(){this.createBall(),c.getCurrentState()===l.READY?this.gameScreen=new V({scene:this},this.ball):c.getCurrentState()===l.CHALLENGE_READY&&(this.challenge=new Y({scene:this},this.ball),this.challenge.loadChallengeLevel(this.registry.get("challenge"))),this.initializeVariables(),this.createDraggingZone(),this.createWalls(),this.configureCamera()}initializeVariables(){this.camera=this.cameras.main,this.sound.setMute(!y.getPlayerData().settings.sound)}createBall(){this.ball=new P({scene:this,x:156,y:.75*this.scale.height,texture:"ball",frame:E.getCurrentSkin()}).setDepth(1).setName("Ball").setCircle(100).setScale(.32).setDepth(0).setGravityY(1200).setFriction(0),this.fakeBall=this.add.circle(300,this.ball.y,0)}createDraggingZone(){this.draggingZone=this.add.rectangle(300,.5*this.scale.height,r,this.scale.height,0,0).setInteractive({draggable:!0})}createWalls(){const e=this.add.image(0,0,"e4").setAlpha(0).setScale(.5),t=[{x:0,y:.5*this.scale.height,origin:{x:1,y:.5}},{x:r,y:.5*this.scale.height,origin:{x:0,y:.5}}];this.walls=t.map((e=>this.add.rectangle(e.x,e.y,50,3*this.scale.height,13224393).setOrigin(e.origin.x,e.origin.y))),this.walls.forEach((t=>{this.physics.add.existing(t),t.body.setImmovable(!0).moves=!1,this.physics.add.collider(this.ball,t,(()=>{C.playWallHitSound(),e.x=this.ball.x,e.y=this.ball.y,e.setTint(E.getCurrentSkinColors()[0]).setAlpha(0).setScale(.5,.1).setFlipX(e.x>300),this.ball.body&&this.ball.setVelocity(1.1*this.ball.body.velocity.x,1.1*this.ball.body.velocity.y),this.add.tween({targets:e,alpha:{value:1,duration:100,yoyo:!0},scaleY:{value:2,duration:200},easing:"Quad.out",onComplete:()=>{e.setAlpha(0)}}),k.setBounce(k.getBounce()+1)}))}))}configureCamera(){this.input.dragDistanceThreshold=10,this.camera.scrollY=this.fakeBall.y-.75*this.scale.height,this.camera.startFollow(this.fakeBall,!1,0,.01,0,.25*this.scale.height)}update(e,t){this.gameScreen&&this.gameScreen.update(e,t),this.challenge&&this.challenge.update(e,t),this.ball.update(e,t),this.draggingZone.y=this.ball.y,this.fakeBall.y=this.ball.y,this.walls[0].y=this.ball.y,this.walls[1].y=this.ball.y}}class j extends Phaser.GameObjects.Image{constructor(e){super(e.scene,e.x,e.y,e.texture,e.frame),this.setInteractive(),this.pointerDownCallback=e.pointerDownCallback,this.pointerUpCallback=e.pointerUpCallback,this.on("pointerdown",this.onPointerDown),this.on("pointerup",this.onPointerUp),this.on("pointerout",this.onPointerOut),this.defaultScale=e.scale,this.setScale(e.scale),this.isDown=!1,e.scene.add.existing(this)}onPointerDown(){this.setScale(.9*this.defaultScale),this.isDown=!0,void 0!==this.pointerDownCallback&&this.pointerDownCallback()}onPointerUp(){this.setScale(this.defaultScale),this.isDown&&(this.isDown=!1,void 0!==this.pointerUpCallback&&this.pointerUpCallback())}onPointerOut(){this.setScale(this.defaultScale)}}class $ extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y),this.skins=[],e.scene.add.existing(this),this.add(this.scene.add.rectangle(300,e.scene.scale.height/2,r,e.scene.scale.height,15066597)),this.rexUI=new u.Z(this.scene,this.scene.plugins,"rexUI"),this.selectedCirc=this.scene.add.ellipse(200,200,140,140,16767293,1),this.createSkinsPanel(),this.add(this.skinsPanel),this.add(this.scene.add.rectangle(300,100,r,200,15066597)),this.add(this.scene.add.image(300,20,"top-ornament")),this.add(this.scene.add.image(300,200,"shop-line").setScale(1.15,1).setTint(9145227)),this.add(this.sizer),this.createBackButton()}createSkinsPanel(){this.skinsPanel=this.rexUI.add.scrollablePanel({x:300,y:this.scene.scale.height/2+100,width:r,height:this.scene.scale.height-200,scrollMode:"v",panel:{child:this.createGrid()},mouseWheelScroller:{focus:!1,speed:.5},space:{left:10,right:10}}).layout();const e=this.skinsPanel;this.scene.tweens.addCounter({from:this.skinsPanel.childOY,to:this.skinsPanel.childOY+this.skinsPanel.centerY-this.skins[E.getCurrentSkin()].y,duration:500,ease:"Quad.out",onUpdate:function(t){e.childOY=t.getValue()}}),this.skinsPanel.setChildrenInteractive({}).on("child.click",(e=>{e.pointerDownCallback&&e.pointerDownCallback()}))}createGrid(){const e=E.getUnlockedSkins();this.skins=[],this.sizer=this.rexUI.add.fixWidthSizer({space:{left:3,right:3,top:20,bottom:20,item:16,line:16},align:"center"}),this.add(this.selectedCirc);for(let t=0;t<116;t++){let s;-1===e.indexOf(t)?(s=new j({scene:this.scene,x:0,y:0,texture:"item",scale:.56,pointerDownCallback:()=>{-1===e.indexOf(t)?T.getCurrentStar()>100&&(T.updateStar(T.getCurrentStar()-100),E.unlockSkin(t),s.setTexture("ball",t)):(E.changeSkin(t),this.selectedCirc.x=this.skins[t].x,this.selectedCirc.y=this.skins[t].y)}}),this.skins.push(s)):this.skins.push(s=new j({scene:this.scene,x:0,y:0,texture:"ball",frame:t,scale:.56,pointerDownCallback:()=>{E.changeSkin(t),this.selectedCirc.x=this.skins[t].x,this.selectedCirc.y=this.skins[t].y}})),this.add(s),this.sizer.add(s)}return this.sizer}createBackButton(){this.add(new j({scene:this.scene,x:36,y:.035*this.scene.scale.height,texture:"back-btn",scale:.3,pointerUpCallback:()=>{c.getPreviousState()!==l.READY&&c.getPreviousState()!==l.PAUSE||c.updateGameState(c.getPreviousState(),this.scene)}}))}update(){this.selectedCirc.x=this.skins[E.getCurrentSkin()].x,this.selectedCirc.y=this.skins[E.getCurrentSkin()].y}}class Z extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y),this.handlePauseButtonClick=()=>{c.getCurrentState()!==l.PLAYING&&c.getCurrentState()!==l.CHALLENGE_PLAYING||(c.emitter.off("game-state-changed",this.onGameStateChanged),c.updateGameState(l.PAUSE,this.scene))},this.handleChallengesButtonClick=()=>{c.updateGameState(l.CHALLENGES_SELECTION,this.scene)},this.handleCustomizeButtonClick=()=>{c.updateGameState(l.CUSTOMIZE,this.scene)},this.handleSettingsButtonClick=()=>{c.updateGameState(l.SETTINGS,this.scene)},this.onGameStateChanged=e=>{e===l.READY?(this.logo.alpha=1,this.customizeBtn.alpha=1,this.challengesBtn.alpha=1,this.help.alpha=1,this.settingsBtn.alpha=1,this.scene.tweens.add({targets:this.logo,y:{value:.25*this.scene.scale.height,duration:500},ease:"Quad.out"})):e===l.GAME_OVER?this.scene.tweens.add({targets:this.pauseBtn,alpha:{value:0,duration:500},ease:"Quad.out"}):e===l.PLAYING&&(this.scene.tweens.add({targets:[this.logo,this.help,this.customizeBtn,this.settingsBtn,this.challengesBtn],alpha:{value:0,duration:500},ease:"Quad.out"}),this.scene.tweens.add({targets:this.pauseBtn,alpha:{value:1,duration:500},ease:"Quad.out"}),this.help.stop())},e.scene.add.existing(this),this.createLogo(),this.createHelpAnimation(),this.createPauseButton(),this.createSettingsButton(),this.createCustomizeButton(),this.createChallengesButton(),this.add(this.logo),this.add(this.help),this.add(this.pauseBtn),this.add(this.customizeBtn),this.add(this.challengesBtn),this.add(this.settingsBtn),c.getCurrentState()===l.CHALLENGE_READY?(this.logo.alpha=0,this.customizeBtn.alpha=0,this.challengesBtn.alpha=0,this.help.alpha=0,this.settingsBtn.alpha=0,this.pauseBtn.setTint(16777215).setAlpha(1)):c.getCurrentState()===l.READY&&this.scene.tweens.add({targets:this.logo,y:{value:.25*this.scene.scale.height,duration:500},ease:"Quad.out"}),c.emitter.on("game-state-changed",this.onGameStateChanged)}createLogo(){this.logo=this.scene.add.image(300,.25*-this.scene.scale.height,"logo").setScale(.85)}createHelpAnimation(){this.help=this.scene.add.sprite(120,.88*this.scene.scale.height,"help").setScale(.6),this.help.anims.create({key:"idle",frames:this.scene.anims.generateFrameNames("help",{start:0,end:23}),frameRate:32,repeat:-1}),this.help.play("idle")}createPauseButton(){this.pauseBtn=new j({scene:this.scene,x:36,y:.035*this.scene.scale.height,texture:"pause-btn",scale:1,pointerUpCallback:this.handlePauseButtonClick}).setAlpha(0).setTint(9145227)}createSettingsButton(){this.settingsBtn=new j({scene:this.scene,x:36,y:.035*this.scene.scale.height,texture:"settings-mainmenu-btn",scale:1,pointerUpCallback:this.handleSettingsButtonClick})}createCustomizeButton(){this.customizeBtn=new j({scene:this.scene,x:330,y:.85*this.scene.scale.height,texture:"customize-mainmenu-btn",scale:.75,pointerUpCallback:this.handleCustomizeButtonClick})}createChallengesButton(){this.challengesBtn=new j({scene:this.scene,x:480,y:.85*this.scene.scale.height,texture:"challenges-btn",scale:.75,pointerUpCallback:this.handleChallengesButtonClick})}destroy(e){super.destroy(e),c.emitter.off("game-state-changed",this.onGameStateChanged)}}class F extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y),e.scene.add.existing(this),this.add(this.scene.add.rectangle(300,e.scene.scale.height/2,r,e.scene.scale.height,15066597));const t=new j({scene:this.scene,x:300,y:.35*this.scene.scale.height,texture:"mainmenu-btn",scale:.4,pointerUpCallback:()=>{c.updateGameState(l.READY,this.scene)}}),s=new j({scene:this.scene,x:300,y:.45*this.scene.scale.height,texture:"customize-btn",scale:.4,pointerUpCallback:()=>{c.updateGameState(l.CUSTOMIZE,this.scene)}}),a=new j({scene:this.scene,x:300,y:.55*this.scene.scale.height,texture:"settings-pause-btn",scale:.4,pointerUpCallback:()=>{c.updateGameState(l.SETTINGS,this.scene)}}),i=new j({scene:this.scene,x:300,y:.65*this.scene.scale.height,texture:"resume-btn",scale:.4,pointerUpCallback:()=>{c.getGameModeState()===o.NORMAL?c.updateGameState(l.PLAYING,this.scene):c.getGameModeState()===o.CHALLENGE&&c.updateGameState(l.CHALLENGE_PLAYING,this.scene)}});this.add(a),this.add(i),this.add(t),this.add(s)}}class Q extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y),this.handleHighScoreUpdated=e=>{this.highScoreText.setText(e.toString())},this.handleScoreUpdated=e=>{this.curScoreText.setText(e.toString())},this.onGameStateChanged=e=>{e===l.GAME_OVER?this.showResult():e===l.CHALLENGES_SELECTION&&this.curScoreText.setVisible(!1)},e.scene.add.existing(this),this.createCurrentScoreText(),this.createBestScoreText(),this.createHighScoreText(),this.createShareBtn(),this.createResetBtn(),this.createSettingsBtn(),this.add(this.curScoreText),this.add(this.bestScoreText),this.add(this.highScoreText),this.add(this.shareBtn),this.add(this.resetBtn),this.add(this.settingsBtn),c.getCurrentState()===l.CHALLENGE_READY&&(this.curScoreText.setVisible(!1),this.highScoreText.setVisible(!1),this.bestScoreText.setVisible(!1)),G.emitter.on("high-score-updated",this.handleHighScoreUpdated),G.emitter.on("score-updated",this.handleScoreUpdated),c.emitter.on("game-state-changed",this.onGameStateChanged)}createShareBtn(){this.shareBtn=new j({scene:this.scene,x:.28*r,y:.8*this.scene.scale.height,texture:"share-btn",scale:.4}).setScale(0)}createResetBtn(){this.resetBtn=new j({scene:this.scene,x:300,y:.8*this.scene.scale.height,texture:"reset-btn",scale:.4,pointerUpCallback:()=>{c.updateGameState(l.READY,this.scene)}}).setScale(0)}createSettingsBtn(){this.settingsBtn=new j({scene:this.scene,x:432,y:.8*this.scene.scale.height,texture:"settings-btn",scale:.4,pointerUpCallback:()=>{c.updateGameState(l.SETTINGS,this.scene)}}).setScale(0)}showResult(){this.resetBtn.setScale(0),this.settingsBtn.setScale(0),this.shareBtn.setScale(0),this.scene.add.tween({targets:[this.resetBtn,this.settingsBtn,this.shareBtn],scale:{value:.4,duration:300},ease:"Quad.out"}),this.scene.add.tween({targets:[this.highScoreText,this.bestScoreText],alpha:{value:1,duration:500},ease:"Quad.out"})}createCurrentScoreText(){this.curScoreText=this.scene.add.bitmapText(300,.17*this.scene.scale.height,"triomphe","0",180).setTint(12698049).setDepth(-3).setOrigin(.5)}createBestScoreText(){this.bestScoreText=this.scene.add.bitmapText(300,.02*this.scene.scale.height,"triomphe","Best Score",40).setTint(16485157).setDepth(-3).setOrigin(.5).setAlpha(0)}createHighScoreText(){this.highScoreText=this.scene.add.bitmapText(300,.07*this.scene.scale.height,"triomphe",y.getHighScore().toString(),90).setTint(16485157).setDepth(-3).setOrigin(.5).setAlpha(0)}destroy(e){super.destroy(e),c.emitter.off("game-state-changed",this.onGameStateChanged)}}class W extends j{constructor(e){super({scene:e.scene,x:e.x,y:e.y,texture:e.textureOn,frame:e.frameOn,scale:e.scale,pointerUpCallback:e.pointerUpCallback,pointerDownCallback:e.pointerDownCallback}),this.isOn=!0,this.s=e}setActive(e){return this.isOn=e,e?this.setTexture(this.s.textureOn,this.s.frameOn):this.setTexture(this.s.textureOff,this.s.frameOff),this}toggle(){this.setActive(!this.isOn)}getActive(){return this.isOn}}class J extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y),e.scene.add.existing(this),this.add(this.scene.add.rectangle(300,e.scene.scale.height/2,r,e.scene.scale.height,15066597)),this.createBackButton(),this.createTexts(),this.createSwitchButtons(),this.createClearDataButton(),this.createUnlimitedButton(),this.add(this.soundBtn),this.add(this.vibrationBtn),this.add(this.nightModeBtn)}createBackButton(){this.add(new j({scene:this.scene,x:36,y:.035*this.scene.scale.height,texture:"back-btn",scale:.3,pointerUpCallback:()=>{const e=c.getPreviousState();e!==l.READY&&e!==l.PAUSE&&e!==l.GAME_OVER||c.updateGameState(e,this.scene)}}))}createTexts(){this.addText(60,.3*this.scene.scale.height,"SOUNDS"),this.addText(60,.4*this.scene.scale.height,"VIBRATION"),this.addText(60,.5*this.scene.scale.height,"NIGHT MODE")}addText(e,t,s){this.add(this.scene.add.bitmapText(e,t,"triomphe",s,50).setTint(12698049).setDepth(-3))}createClearDataButton(){this.add(new j({scene:this.scene,x:300,y:.7*this.scene.scale.height,texture:"cleardata-btn",scale:.5,pointerUpCallback:()=>{p.deleteAll()}}))}createUnlimitedButton(){this.add(new j({scene:this.scene,x:300,y:.8*this.scene.scale.height,texture:"unlimited-btn",scale:.5,pointerUpCallback:()=>{T.updateStar(99999)}}))}createSwitchButtons(){this.soundBtn=this.createSwitchButton(420,.3*this.scene.scale.height,x.SOUND).setActive(y.getPlayerData().settings.sound),this.vibrationBtn=this.createSwitchButton(420,.4*this.scene.scale.height,x.VIBRATION).setActive(y.getPlayerData().settings.vibration),this.nightModeBtn=this.createSwitchButton(420,.5*this.scene.scale.height,x.NIGHT_MODE).setActive(y.getPlayerData().settings.nightMode)}createSwitchButton(e,t,s){const a=new W({scene:this.scene,x:e,y:t,textureOn:"rounded-btn",frameOn:0,textureOff:"rounded-btn",frameOff:1,scale:.5,pointerUpCallback:()=>{a.toggle(),y.setSettings(s,a.getActive())}}).setOrigin(0);return a}}class q extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y),this.handleStarUpdated=e=>{this.starText.setText(e.toString())},this.handleGameState=e=>{e===l.CUSTOMIZE?this.starText.setTint(16777215):e!==l.PLAYING&&e!==l.PAUSE||this.starText.setTint(16485157)},e.scene.add.existing(this),this.createStarIcon(),this.createStarText(),this.add(this.starIcon),this.add(this.starText),T.emitter.on("star-updated",this.handleStarUpdated),c.emitter.on("game-state-changed",this.handleGameState)}createStarText(){this.starText=this.scene.add.bitmapText(540,.035*this.scene.scale.height,"triomphe",T.getCurrentStar().toString(),36).setTint(16485157).setDepth(-3).setOrigin(0,.7)}createStarIcon(){this.starIcon=this.scene.add.image(510,.035*this.scene.scale.height,"star").setScale(.3)}}class K extends Phaser.GameObjects.Container{constructor(e){if(super(e.scene,e.x,e.y),this.onGameStateChanged=e=>{if(e===l.CHALLENGE_COMPLETE)this.scene.tweens.add({targets:this,scale:1,ease:"Back.out",duration:300}),this.textButton.setText("BACK"),this.button.pointerUpCallback=()=>{c.updateGameState(l.CHALLENGES_SELECTION,this.scene)};else if(e===l.CHALLENGE_PLAYING)this.scene.tweens.add({targets:this,scale:0,ease:"Quad.out",duration:300});else if(e===l.CHALLENGE_READY){this.scene.tweens.add({targets:this,scale:1,ease:"Back.out",duration:300});const{name:e,level:t}=this.scene.registry.get("challenge");this.description.setText(h[e].description),this.title.setText(`CHALLENGE ${t}`);const s=h[e].color;this.bg.setTint(s),this.button.setTint(s)}},e.scene.add.existing(this),this.createChallengePopUp(),this.createButton(),this.createTitle(),this.createDescription(),this.createBackground(),this.add(this.challengePopUp),this.add(this.button),this.add(this.textButton),this.add(this.bg),this.add(this.title),this.add(this.description),this.scale=0,c.getCurrentState()===l.CHALLENGE_READY){this.scene.tweens.add({targets:this,scale:1,ease:"Back.out",duration:300});const{name:e,level:t}=this.scene.registry.get("challenge");this.description.setText(h[e].description.replace("[x]",this.scene.registry.get("goal").slice(2))),this.title.setText(`CHALLENGE ${t}`);const s=h[e].color;this.bg.setTint(s),this.button.setTint(s)}c.emitter.on("game-state-changed",this.onGameStateChanged)}createBackground(){this.bg=this.scene.add.image(0,-40,"challenge-popup-bg").setScale(.7)}createDescription(){this.description=this.scene.add.bitmapText(0,-50,"triomphe","",28).setOrigin(.5)}createTitle(){this.title=this.scene.add.bitmapText(0,-135,"triomphe","CHALLENGE",32).setOrigin(.5).setTint(9145227)}createChallengePopUp(){this.challengePopUp=this.scene.add.image(0,0,"challenge-popup").setScale(.7)}createButton(){this.button=new j({scene:this.scene,x:0,y:90,texture:"challenge-btn",scale:.7,pointerUpCallback:()=>{c.updateGameState(l.CHALLENGE_PLAYING,this.scene)}}),this.textButton=this.scene.add.bitmapText(0,80,"triomphe","PLAY",28).setOrigin(.5)}destroy(e){super.destroy(e),c.emitter.off("game-state-changed",this.onGameStateChanged)}}const X=[n.TIME,n.SCORE,n.BOUNCE,n.NO_AIM];class ee extends Phaser.GameObjects.Container{constructor(e){super(e.scene,e.x,e.y),this.scene.add.existing(this),this.add(this.scene.add.rectangle(300,e.scene.scale.height/2,r,e.scene.scale.height,15066597)),this.rexUI=new u.Z(this.scene,this.scene.plugins,"rexUI"),this.createBackButton(),this.createChallenges(),this.add(this.sizer),this.add(this.scene.add.image(300,20,"top-ornament").setDepth(-2)),this.add(this.backBtn);const t=this.sizer.getChildren();for(let e=0;e<t.length;e++){const s=this.scene.add.shader("shader",t[e].x,t[e].y,t[e].displayWidth,t[e].displayHeight);s.setChannel0(`${X[e]}-btn-2`),s.setChannel1(`${X[e]}-icon-2`),this.add(s)}}createChallenges(){this.sizer=this.rexUI.add.fixWidthSizer({x:300,y:this.scene.scale.height/2+250,width:120,height:this.scene.scale.height,space:{left:10,right:10}});const e={padding:{top:10,bottom:10}};for(const t of X)this.sizer.add(new j({x:0,y:0,scene:this.scene,texture:`${t}-btn`,scale:.8,pointerUpCallback:()=>{const e=y.getChallengeLevel(t)+1;e<=h[t].levels&&(this.scene.registry.set("challenge",{name:t,level:e}),c.updateGameState(l.CHALLENGE_READY,this.scene))}}),e);this.sizer.layout().setChildrenInteractive({}).on("child.click",(e=>{e.pointerUpCallback&&e.pointerUpCallback()}))}createBackButton(){this.backBtn=new j({scene:this.scene,x:36,y:.035*this.scene.scale.height,texture:"back-btn",scale:.3,pointerUpCallback:()=>{c.updateGameState(l.READY,this.scene)}})}}class te extends Phaser.Scene{constructor(){super("hud"),this.onGameStateChanged=(e,t)=>{e===l.PLAYING?this.mainMenu.setVisible(!0):e===l.PAUSE?(this.pause.setVisible(!0),this.mainMenu.setVisible(!1)):e===l.SETTINGS?(this.mainMenu.setVisible(!1),this.settings.setVisible(!0),this.result.setVisible(!1),this.star.setVisible(!1)):e===l.CHALLENGES_SELECTION?(this.challengeSelection.setVisible(!0),this.challengePopup.setVisible(!1),this.mainMenu.setVisible(!1),this.star.setVisible(!1)):e===l.CHALLENGE_READY?(this.challengePopup.setVisible(!0),this.challengeSelection.setVisible(!1),this.challengeTopbar.setVisible(!0)):e===l.GAME_OVER?(this.result.setVisible(!0),this.mainMenu.setVisible(!1)):e===l.CUSTOMIZE?(this.customize.setVisible(!0),this.mainMenu.setVisible(!1)):e===l.CHALLENGE_PLAYING&&this.mainMenu.setVisible(!0),t===l.SETTINGS?this.settings.setVisible(!1):t===l.PAUSE?this.pause.setVisible(!1):t===l.CUSTOMIZE&&this.customize.setVisible(!1)}}create(){this.initScreens(),c.emitter.on("game-state-changed",this.onGameStateChanged),this.events.on("shutdown",(()=>{c.emitter.off("game-state-changed",this.onGameStateChanged)}))}initScreens(){this.challengeTopbar=new H({scene:this}),this.challengeTopbar.setVisible(c.getCurrentState()===l.CHALLENGE_READY),this.challengeSelection=new ee({scene:this}),this.challengeSelection.setVisible(!1),this.challengePopup=new K({scene:this,x:300,y:this.scale.height/2}),this.result=new Q({scene:this}),this.mainMenu=new Z({scene:this}),this.settings=new J({scene:this}).setVisible(!1),this.pause=new F({scene:this}).setVisible(!1),this.customize=new $({scene:this}).setVisible(!1),this.star=new q({scene:this}).setVisible(c.getCurrentState()!==l.CHALLENGE_READY)}update(e,t){this.customize.update()}}const se={type:i().WEBGL,physics:{default:"arcade",arcade:{gravity:{y:0}}},scale:{width:r,height:window.innerHeight>window.innerWidth?r*window.innerHeight/window.innerWidth:1e3,parent:"phaser-game",mode:i().Scale.FIT,autoCenter:i().Scale.CENTER_BOTH},plugins:{scene:[{key:"rexUI",plugin:u.Z,mapping:"rexUI"}]},roundPixels:!0,backgroundColor:"0xe5e5e5",scene:[d,z,te]};new(i().Game)(se)}},s={};function a(e){var i=s[e];if(void 0!==i)return i.exports;var r=s[e]={exports:{}};return t[e].call(r.exports,r,r.exports,a),r.exports}a.m=t,e=[],a.O=(t,s,i,r)=>{if(!s){var n=1/0;for(c=0;c<e.length;c++){for(var[s,i,r]=e[c],h=!0,l=0;l<s.length;l++)(!1&r||n>=r)&&Object.keys(a.O).every((e=>a.O[e](s[l])))?s.splice(l--,1):(h=!1,r<n&&(n=r));if(h){e.splice(c--,1);var o=i();void 0!==o&&(t=o)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[s,i,r]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};a.O.j=t=>0===e[t];var t=(t,s)=>{var i,r,[n,h,l]=s,o=0;if(n.some((t=>0!==e[t]))){for(i in h)a.o(h,i)&&(a.m[i]=h[i]);if(l)var c=l(a)}for(t&&t(s);o<n.length;o++)r=n[o],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(c)},s=self.webpackChunktype_project_template=self.webpackChunktype_project_template||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var i=a.O(void 0,[216],(()=>a(413)));i=a.O(i)})();